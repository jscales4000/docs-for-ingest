!function(){"use strict";angular.module("helium",["ngRoute","ngAnimate","ui.bootstrap","pascalprecht.translate","tmh.dynamicLocale","ngSanitize"])}(),function(){"use strict";angular.module("helium").component("hlmTimeGroupRoller",{templateUrl:"views/components/time-group-roller.html",controller:"TimeRollerGroupCtrl",transclude:!0,bindings:{formatTime:"<",hoursFormat:"<",minutesFormat:"<",ampmFormat:"<",langArabic:"<",startDate:"<",endDate:"<",step:"<",label:"=",data:"<",value:"=",hoursRange:"<",minutesRange:"<",ampmRange:"<",isSelected:"<"}})}(),function(){"use strict";function e(){var a=this,i={value:null,hour:null};function o(e,t){return new Date(e.getTime()+6e4*t)}function e(e,t){var n,i;a.hoursRange=(n=e,i=t,{options:e=function(){for(var e=[],t=new Date(n);t<i;)t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),e.push(t),t=o(t,60);return e.length&&i.getHours()===e[e.length-1].getHours()||e.push(i),e}(),value:e[0]})}function s(e,t){var n,i;a.minutesRange=(n=e,i=t,{options:e=function(){var e=[],t=n;for(0===i.getHours()?(i=new Date(i)).setMinutes(0):n.getHours()<i.getHours()&&(i=new Date(n)).setMinutes(59);t<i;)e.push(t),t=o(t,1);return e.length&&i.getMinutes()===e[e.length-1].getMinutes()||e.push(i),e}(),value:e[0]})}function l(e,t){var n,i;a.ampmFormat&&(a.ampmRange=(t=t,n=(e=e).getHours(),i=t.getDay()!==e.getDay()?24:e.getHours(),n<12&&i<12?{options:[e],value:e}:n<12&&12<=i?{options:[e,t],value:e}:12<=n&&12<=i?i<24?{options:[t],value:t}:{options:[e],value:e}:void 0))}function t(){a.startDate&&a.endDate&&(a.ampmFormat=a.ampmFormat||!1,e(a.startDate,a.endDate),s(a.startDate,a.endDate),l(a.startDate,a.endDate))}a.$onInit=function(){a.data&&a.data.options||t()},a.$onChanges=function(e){a.data&&a.data.options||(e.startDate||e.endDate)&&t()},a.$doCheck=function(){var e,t,n;a.data&&a.data.options?!a.data.value||i.value&&i.value.getTime()===a.data.value.getTime()||(a.value=i.value=a.data.value):a.hoursRange&&a.minutesRange&&(t=(e=new Date).getDate(),n=new Date(a.hoursRange.value),e.setDate(n.getDate()),e.setHours(n.getHours()),e.setMinutes(t!==n.getDate()?0:new Date(a.minutesRange.value).getMinutes()),e.setSeconds(0),e.setMilliseconds(0),!e.getTime()||i.value&&i.value.getTime()===e.getTime()||(a.value=i.value=e),!n.getTime()||i.hour&&n.getTime()===i.hour.getTime()||(i.hour=n,a.startDate&&(s(new Date(Math.max(n.getTime(),a.startDate.getTime())),a.endDate),l(new Date(Math.max(n.getTime(),a.startDate.getTime())),a.endDate))),!n.getTime()||i.hour&&n.getTime()===i.hour.getTime()||(i.hour=n,a.startDate&&(s(new Date(Math.max(n.getTime(),a.startDate.getTime())),a.endDate),l(new Date(Math.max(n.getTime(),a.startDate.getTime())),a.endDate))))}}angular.module("helium").controller("TimeRollerGroupCtrl",e),e.$inject=[]}(),function(){"use strict";angular.module("helium").component("hlmTimeline",{templateUrl:function(){return"views/components/timeline.html"},controller:"TimelineCtrl",transclude:!0,bindings:{timelinePlacement:"@",timelineViewport:"@",timelineBlockSize:"@",timelineBlockHorizontalSize:"@",timelineBlockVerticalSize:"@",timelineNrHours:"@",timelineStartHour:"@",timelineMinutesScale:"@",timelineEvents:"<",timelineDisableInteraction:"<",timelinePauseAutoScroll:"<",timelineOpenNewEvent:"&",timelineOpenEvent:"&",timelineDisableClick:"<",timelineDisableDetailsClick:"<",timelineDisableAutoScroll:"<",timelineDialog:"@",timelineLabelTop:"@",timelineLabelRight:"@",timelineArabic:"@",timelineDateHourMarker:"<",timelineDateHourFormat:"<",timelineDateTimeFormat:"<",timelineIntervalAutoScroll:"@",timelineEvent:"<",timelineEventTitle:"<",timelineLabelNoon:"<",timelineNextMeetingCheckedIn:"<"}})}(),function(){"use strict";function e(c,e,n,i){var t,a,o,s,m=this,r={blockHorizontalSize:322,blockVerticalSize:113,dialogWidthPercent:.43,dialogBlockPercent:3.5,nrHours:24,lastHour:24,startHour:0,scale:2,placement:"horizontal",disableClick:!1,disableDetailsClick:!1,disableAutoScroll:!1,pauseAutoScroll:!1,labelTop:!0,labelRight:!0,verticalVisibleBlocks:6,horizontalVisibleBlocks:10,dateHourFormat:"h",dateHourMarker:"a",dateTimeFormat:"h:mm a",intervalScrollToNow:6e4,intervalScrollToCurrentHour:36e5,intervalAutoScroll:1e4},l={stopScrolling:!1},u=!1,d=!1;function v(){s&&(s.removeEventListener("touchstart",h,{passive:!0}),s.removeEventListener("touchend",p,{passive:!1})),u=!1,clearTimeout(t)}function g(){s&&!1===u&&(u=!0,s.addEventListener("touchstart",h,{passive:!0}),s.addEventListener("touchend",p,{passive:!1}))}function h(e){1<e.touches.length||(d=!0,l.stopScrolling=!0,m.disableAutoScroll)||m.pauseAutoScroll||b()}function p(e){0<e.touches.length||(d=!1,l.stopScrolling=!1,m.disableAutoScroll)||m.pauseAutoScroll||f()}function f(){var e;m.disableAutoScroll||m.pauseAutoScroll||d||(e=m.intervalAutoScroll,clearTimeout(t),t=setTimeout(function(){d?f():null!=s?H(s):y()},e))}function b(){clearTimeout(t)}function H(e){var t=S();"vertical"===m.placement||"portrait"===m.placement?i.scroll(e,t,2e3,"vertical"):i.scroll(e,t,2e3)}function E(e){var t,n;return e&&!isNaN(e)&&(t=Math.floor(e/m.blockSize)+m.startHour,n=Math.floor(e%m.blockSize*60/m.blockSize)),{hours:t,minutes:n}}function S(){var e=E(m.currentTimePosition);return e.minutes=0,e=M(e),isNaN(e)||(m.isArabic&&(e=m.timelineSize-e-m.timelineViewport),isNaN(e))?0:e}function M(e){var t;return!e||isNaN(e.hours)||isNaN(e.minutes)||(t=m.blockSize*(e.hours-m.startHour),t+=m.blockSize/60*e.minutes),t}function w(e){for(var t=e,n=0,i=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)n+=t.offsetLeft-t.scrollLeft,i+=t.offsetTop-t.scrollTop,t=t.offsetParent;return{left:n,top:i}}function T(e,t){var n=new Date;return e<n&&n<=t}function D(e){return e<new Date}function C(e){var t=e.dtStart,e=e.dtEnd,n={hours:t.getHours(),minutes:t.getMinutes()},t=(e=e,t=t,e=Math.abs(e-t)/1e3,t=Math.floor(e/3600),e-=3600*t,e=Math.floor(e/60)%60,{hours:t,minutes:e});return{startPosition:M(n),size:M(t)}}function y(){var e=new Date,t={hours:e.getHours(),minutes:e.getMinutes()};m.now=e,m.currentTimePosition=M(t),!s||m.disableAutoScroll||m.pauseAutoScroll||d||H(s)}function k(){"portrait"===m.placement?m.timelineViewport=.375*window.innerHeight:"vertical"===m.placement?m.timelineViewport=m.timelineViewport?parseInt(m.timelineViewport):window.innerHeight:m.timelineViewport=m.timelineViewport?parseInt(m.timelineViewport):window.innerWidth}function R(){var e;m.disableClick=!0,m.disableDetailsClick=!0,m.disableAutoScroll=!0,m.centerEvent=!0,e=m.timelineEvents,angular.forEach(m.timelineEvents,function(e){e.selected=!1}),m.timelineEvents=[],angular.extend(m.timelineEvents,e),n.cancel(a)}function A(e){return"string"==typeof e||e instanceof String}function $(){setTimeout(function(){v();var e=document.getElementsByClassName("timeline--"+m.placement);e.length&&!u&&(s=e[0],k(),(e=s)&&("vertical"===m.placement||"portrait"===m.placement?e.style.setProperty("height",m.timelineViewport+"px"):e.style.setProperty("width",m.timelineViewport+"px")),g())},0)}i.setConfig(l),m.getStyle=function(e){e=C(e);return"vertical"===m.placement||"portrait"===m.placement?{height:e.size+"px",top:e.startPosition+"px"}:{width:e.size+"px",left:e.startPosition+"px"}},m.isEventActive=function(e){var t=!1;return m.timelineDisableInteraction||T(e.dtStart,e.dtEnd)&&(t=!0),t},m.isEventFinished=function(e){var t=!1;return m.timelineDisableInteraction||D(e.dtEnd)&&(t=!0),t},m.isEventSelected=function(e){var t=!1;return t=m.timelineDisableInteraction&&e.selected?!0:t},m.isRoomReserved=function(){return null!==c.Helium.values.mainRoom.currentEvent},m.isSubBlockFinished=function(e,t){var n=E(m.currentTimePosition);m.scale,c.Helium.settings&&c.Helium.settings.reservation&&c.Helium.settings.reservation.reserveNowMinDur?60<(i=c.Helium.settings.reservation.reserveNowMinDur)?i=60:i<5&&(i=5):i=15;var i,a=60/(60/i),o=e.subHours[t].start.getHours(),s=e.subHours[t].start.getMinutes();if(n.hours>o)return!0;if(n.hours===o&&0===s&&30<=n.minutes)return!0;if(c.Helium.settings.reservation.reserveNowEvenEndTime){e=c.Helium.values.mainRoom.events;if(void 0!==e)for(var l=e.filter(function(e){return e.dtStart.getHours()>n.hours||e.dtStart.getHours()===n.hours&&e.dtStart.getMinutes()>n.minutes}),r=0,r=0;r<l.length;r++){var u=l[r];if(u.dtStart.getHours()===o&&u.dtStart.getMinutes()>s)return u.dtStart.getMinutes()-s<a}}return!1},m.onClickBlock=function(e){var t,n,i,a,o,s;m.disableClick||(s=e.pageX,o=e.pageY,a=(i=e.currentTarget.parentElement).parentElement,i=w(i),t=new Date,n=new Date,0<=e.target.className.indexOf("timeline__content__block__subBlocks__subBlock")&&(o="vertical"===m.placement||"portrait"===m.placement?o-i.top+a.scrollTop:s-i.left+a.scrollLeft,s=E(o=m.isArabic?isNaN(o)?0:m.timelineSize-o:o),n.setHours(s.hours,s.minutes,0,0),t<=n?m.timelineOpenNewEvent()(n):(i=w(e.target),a=m.subBlockSize+i.left,o=m.subBlockSize+i.top,s=m.currentTimePosition,"vertical"===m.placement||"portrait"===m.placement?s>i.top&&s<o&&m.timelineOpenNewEvent()(t):s>i.left&&s<a&&m.timelineOpenNewEvent()(t))))},m.onClickEventBlock=function(e){m.disableDetailsClick||(e.selected=!0,m.timelineOpenEvent()(e))},m.$onInit=function(){var e,t;m.intervalAutoScroll=m.timelineIntervalAutoScroll?parseInt(m.timelineIntervalAutoScroll):r.intervalAutoScroll,m.timelineDateHourFormat=A(m.timelineDateHourFormat)?m.timelineDateHourFormat:r.dateHourFormat,m.timelineDateHourMarker=A(m.timelineDateHourMarker)?m.timelineDateHourMarker:r.dateHourMarker,m.timelineDateTimeFormat=A(m.timelineDateTimeFormat)?m.timelineDateTimeFormat:r.dateTimeFormat,m.placement=m.timelinePlacement||r.placement,m.scale=m.timelineMinutesScale?parseInt(m.timelineMinutesScale)+1:r.scale,m.timelineArabic="true"===m.timelineArabic||"false"!==m.timelineArabic&&!0===m.timelineArabic,m.showNoon=!m.timelineArabic,m.isArabic=!(!m.timelineArabic||"horizontal"!==m.placement),k(),"vertical"===m.placement||"portrait"===m.placement?m.blockSize=m.timelineBlockVerticalSize?parseInt(m.timelineBlockVerticalSize):r.blockVerticalSize:m.blockSize=m.timelineBlockHorizontalSize?parseInt(m.timelineBlockHorizontalSize):r.blockHorizontalSize,m.subBlockSize=Math.round(m.blockSize/m.scale),t=m.scale,m.blockSize=m.blockSize+t/2,m.startHour=parseInt(m.timelineStartHour)||r.startHour,m.nrHours=parseInt(m.timelineNrHours)||r.nrHours,(t=r.lastHour-m.startHour)<m.nrHours&&(m.nrHours=t),m.timelineSize=m.blockSize*m.nrHours,m.arrayHours=function(e,t){for(var n,i,a,o=[],s=t,l=(e=e+t)>r.lastHour?r.lastHour:e;s<l;s++)(n=new Date).setHours(s),n.setMinutes(0),n.setSeconds(0),(i=new Date).setHours(s),i.setMinutes(0),i.setSeconds(0),(a=new Date).setHours(s),a.setMinutes(30),a.setSeconds(0),o.push({date:n,subHours:[{start:i},{start:a}]});return o}(m.nrHours,m.startHour),m.timelineEvents=m.timelineEvents||[],angular.forEach(m.timelineEvents,function(e){var t=C(e);e.finished=!!D(e.dtEnd),e.active=!!T(e.dtStart,e.dtEnd),e.startPosition=t.startPosition,e.size=t.size}),m.timelineEvent&&(e=C(t=m.timelineEvent),t.startPosition=e.startPosition,t.size=e.size),y(),o=setTimeout(function(){y(),a=n(function(){y()},r.intervalScrollToNow)},60020-(new Date).getTime()%6e4),m.disableClick=void 0!==m.timelineDisableClick&&!0===m.timelineDisableClick||r.disableClick,m.disableAutoScroll=void 0!==m.timelineDisableAutoScroll&&!0===m.timelineDisableAutoScroll||r.disableAutoScroll,m.pauseAutoScroll=void 0!==m.timelinePauseAutoScroll&&!0===m.timelinePauseAutoScroll,m.timelineEventTitle=void 0!==m.timelineEventTitle&&!0===m.timelineEventTitle,m.disableDetailsClick=void 0!==m.timelineDisableDetailsClick&&!0===m.timelineDisableDetailsClick||r.disableDetailsClick,m.timelineDisableInteraction&&R(),t=m.timelineEvent?C(m.timelineEvent).startPosition:S(),m.jumpScrollToPosition=t,"vertical"===m.placement||"portrait"===m.placement?m.labelTop=(!m.timelineLabelRight||"true"!==m.timelineLabelRight)&&r.labelTop:m.labelTop=(!m.timelineLabelTop||"false"!==m.timelineLabelTop)&&r.labelTop},m.$onChanges=function(e){angular.isDefined(e.timelinePlacement)&&(m.placement=e.timelinePlacement.currentValue,$()),angular.isDefined(e.timelineColorTheme)&&$(),angular.isDefined(e.timelineDisableClick)&&(m.disableClick=e.timelineDisableClick.currentValue),angular.isDefined(e.timelineDisableDetailsClick)&&(m.disableDetailsClick=e.timelineDisableDetailsClick.currentValue),e.timelinePauseAutoScroll&&(m.pauseAutoScroll=e.timelinePauseAutoScroll.currentValue,(m.pauseAutoScroll?b:f)()),e.timelineDisableAutoScroll&&(m.disableAutoScroll=e.timelineDisableAutoScroll.currentValue,(m.disableAutoScroll?v:g)())},m.$postLink=function(){$()},m.$onDestroy=function(){v(),n.cancel(a),clearTimeout(t),clearTimeout(o),s=null}}angular.module("helium").controller("TimelineCtrl",e),e.$inject=["$rootScope","$scope","$interval","SmoothScrollService"]}(),function(){"use strict";function e(){var d=this;function v(e,t,n){n=function(e,t,n){e<t&&(e=t);n<e&&(e=n);return e}((n-e)/(t-e),0,1);return n*n*n*(n*(6*n-15)+10)}this.setConfig=function(e){d.config=e},this.scroll=function(s,e,t,n){var l,r,u="vertical"===n?"scrollTop":"scrollLeft",c=s[u],m=Date.now(),n=(d.config.stopScrolling=!1,parseInt(e)),e=parseInt(t);return 0===e?(s[u]=n,Promise.resolve()):(l=m+e,r=n-c,0===Math.round(r)?Promise.resolve():new Promise(function(i){var a,o=function(){var e,t,n=Date.now();!0===d.config.stopScrolling||(e=v(m,l,n),e=parseFloat(c+r*e).toFixed(2),t=s[u],l<=n)||t===a&&t!==e?i():(s[u]=e,a=e,window.requestAnimationFrame(o))};window.requestAnimationFrame(o)}))}}angular.module("helium").service("SmoothScrollService",e),e.$inject=[]}(),function(){"use strict";function e(l){return{restrict:"A",scope:{jumpTo:"=",placement:"=",event:"<",timelineSize:"<",timelineViewport:"<",isArabic:"<",timelineDialog:"<"},replace:!1,link:function(a,o){var s=a.$watch("jumpTo",function(e){var t=o.parent().parent(),n="vertical"===a.placement||"portrait"===a.placement?t.height():t.width(),i=e;"portrait"===a.placement&&(n=.375*t.height()),a.event&&(a.isArabic&&(e=n-a.event.size,i=a.timelineSize-a.event.startPosition-a.event.size-e),n)&&setTimeout(function(){var e,t;o[0].style.width=n+"px","vertical"===a.placement||"portrait"===a.placement?o[0].scrollTop=i:a.timelineDialog&&l.isRtl?(e=.016,1<(t=window.devicePixelRatio)?e=500<a.timelineViewport?.018:.028:t<1&&(e=.014),o[0].scrollLeft=i-a.timelineViewport*e):o[0].scrollLeft=i},500),"vertical"===a.placement||"portrait"===a.placement?o[0].scrollTop=i:o[0].scrollLeft=i,s()})}}}angular.module("helium").directive("hlmScrollInit",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e){var a=null,o="views/partials/room.html";e.when("/page/:page",{resolve:{checkTemplate:["$rootScope","$route","templateService","$q",function(e,t,n,i){i=i.defer();return a=n.getPageTemplateUrl(t.current.params.page),!e.Helium.state.offlineLimit||a===o?i.resolve():(i.reject(),a=o),i.promise}]},templateUrl:function(){return a||o}}).otherwise({redirectTo:o})}angular.module("helium").config(e),e.$inject=["$routeProvider"]}(),function(){"use strict";function e(e){e.preferredLanguage("en"),e.useSanitizeValueStrategy("escape")}function t(e){e.defaultLocale("en"),e.localeLocationPattern("bower_components/angular-i18n/angular-locale_{{locale}}.js")}angular.module("helium").config(e).config(t),e.$inject=["$translateProvider"],t.$inject=["tmhDynamicLocaleProvider"]}(),function(){"use strict";angular.module("helium").constant("AppConfig",{delayTime:1e4,hourInMin:60,arabicLanguage:!1,template:{arabicTemplateSuffix:"_arabic",modalFolderPath:"views/modals/",pageFolderPath:"views/partials/"},screenSaverDelay:3e5,errorMsgCloseDelay:1e4,successMsgCloseDelay:1e4,timeoutLoadingMask:6e4,timeoutPendingRoom:6e4})}(),function(){"use strict";function e(n,i,a,o,e,t){var s=!1,l={state:!0,message:i.Helium.labels.details.loadingMessage};n.working=!1,n.data={},angular.extend(i.Helium.state.loading,l),i.$watch("Helium.state.isOnline",function(e){s&&(n.data.helpProviderData.isOnline=e)}),i.$watch("Helium.state.refreshingProvider",function(e){n.working=e}),e.sendAbout(function(e,t){i.$evalAsync(function(){e?(n.data=t.data,s=!0,o.get("appInfo.json").then(function(e){i.Helium.state.loading.state=!1,n.data.helpVersionData=n.data.helpVersionData||{},n.data.helpVersionData.web=e.data.version},function(){console.log("Invalid appInfo.json file"),i.Helium.state.loading.state=!1})):(console.log("NO data received"),a.close(),i.Helium.state.loading.state=!1)})}),n.cancel=function(){a.dismiss("cancel")},n.refresh=function(){n.working||(n.working=!0,t.setRefreshProviderTimeout(),e.sendRefreshSchedule(function(){}))}}angular.module("helium").controller("AboutCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance","$http","CommunicationService","AppStateService"]}(),function(){"use strict";function e(e,t,n){e.event=n,e.cancel=function(){t.dismiss("cancel")}}angular.module("helium").controller("DetailsCtrl",e),e.$inject=["$scope","$uibModalInstance","event"]}(),function(){"use strict";function e(n,i,a,o,s){var l=!1;n.loading={state:!1,message:i.Helium.labels.endEvent.loadingMessage,showErrorMessageTimeout:!1,responseReceived:!1},n.event=i.Helium.values.mainRoom.currentEvent,i.$on("currentEvent",a.close),n.end=function(){var e,t;l||(e=i.Helium.values.mainRoom.currentEvent,i.$evalAsync(function(){l=!0,n.loading.state=!0,angular.extend(i.Helium.state.loading,n.loading)}),t=setTimeout(function(){i.$evalAsync(function(){n.loading.responseReceived||(n.loading.showErrorMessageTimeout=!0,n.loading.state=i.Helium.state.loading.state=!1,a.close(),i.Helium.methods.openMsgError("EndEvent"))})},s.timeoutLoadingMask),o.sendEndEvent(e.id,e.instanceId,function(e){n.loading.showErrorMessageTimeout||(n.loading.responseReceived=!0,clearTimeout(t),i.$evalAsync(function(){n.loading.state=i.Helium.state.loading.state=!1,l=!1,e||i.Helium.methods.openMsgError("EndEvent"),a.close()}))}))},n.cancel=function(){a.dismiss("cancel")}}angular.module("helium").controller("EndEventCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance","CommunicationService","AppConfig"]}(),function(){"use strict";function e(e,t,n,i){var a=setTimeout(function(){t.close()},n.errorMsgCloseDelay);e.addEvent=i,e.cancel=function(){t.dismiss("cancel")},e.$on("$destroy",function(){clearTimeout(a)})}angular.module("helium").controller("ErrorMsgCtrl",e),e.$inject=["$scope","$uibModalInstance","AppConfig","addEvent"]}(),function(){"use strict";function e(n,i,a,e,o,s){var t=n.Helium.values.mainRoom,l=t.currentEvent,t=t.nextEvent,r=!1;i.$on("currentEvent",a.close),n.loading={state:!1,message:i.Helium.labels.extendEvent.loadingMessage,showErrorMessageTimeout:!1,responseReceived:!1},n.event=i.Helium.values.mainRoom.currentEvent,n.duration={},n.duration.options=e.generateAvailableExtendTime(l.dtEnd,t&&t.dtStart?t.dtStart:null,15),n.duration.value=n.duration.options[0],n.extend=function(){var t;r||(i.$evalAsync(function(){r=!0,n.loading.state=!0,angular.extend(i.Helium.state.loading,n.loading)}),t=setTimeout(function(){i.$evalAsync(function(){n.loading.responseReceived||(n.loading.showErrorMessageTimeout=!0,n.loading.state=i.Helium.state.loading.state=!1,a.close(),i.Helium.methods.openMsgError("ExtendEvent"))})},s.timeoutLoadingMask),o.sendExtendEvent(l.id,l.instanceId,n.duration.value,function(e){n.loading.showErrorMessageTimeout||(n.loading.responseReceived=!0,clearTimeout(t),i.$evalAsync(function(){n.loading.state=i.Helium.state.loading.state=!1,r=!1,e||i.Helium.methods.openMsgError("ExtendEvent"),a.close()}))}))},n.cancel=function(){a.dismiss("cancel")}}angular.module("helium").controller("ExtendEventCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance","TimelineService","CommunicationService","AppConfig"]}(),function(){"use strict";function e(o,s,e,t){var n=null==(n=s.Helium.values.roomId)?"":n;o.model={rooms:[],isLoading:!0},t.sendRoomSearch(n,function(i,a){o.$evalAsync(function(){if(o.model.isLoading=!1,i){var t,e=o.model;if(e.rooms=a.data&&a.data.rooms?a.data.rooms:[],e.noRooms=!(a.data&&a.data.rooms&&a.data.rooms.length),0<e.rooms.length)for(var n=0;n<e.rooms.length;n++)e.rooms[n].id===s.pendingReservation.prevRoomID&&e.rooms.splice(n,1);angular.forEach(o.model.rooms,function(e){t=e.freeUntil||!1,e.availableForDuration=s.Helium.state.getRemainingTimeString({dtEnd:t})})}})}),o.openReservation=function(e){s.Helium.settings.reservation.reservationEnable&&s.Helium.methods.openReservation(!1,e)},o.cancel=function(){e.dismiss("cancel")}}angular.module("helium").controller("FindRoomCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance","CommunicationService"]}(),function(){"use strict";function e(n,e,t){var i=e.Helium.settings.accessControl.pin?e.Helium.settings.accessControl.pin.toString():[];function a(){var e,t=i.length;if(t)for(e=0;e<t;e++)n.pinCircles.push({set:!1})}function o(){n.disablePinEntry=!0,$(".pin__container__header__password").addClass("shake"),setTimeout(function(){n.$evalAsync(function(){n.pin="",n.pinCircles.splice(0,n.pinCircles.length),a(),n.disablePinEntry=!1}),$(".pin__container__header__password").removeClass("shake")},400)}n.pin="",n.pinCircles=[],n.disablePinEntry=!1,a(),n.deteleCircle=function(){n.$evalAsync(function(){n.pin=n.pin.substr(0,n.pin.length-1),n.pinCircles[n.pin.length].set=!1})},n.$watch("pin",function(e){e&&e.length<=i.length&&(n.pinCircles[e.length-1].set=!0,e===i?setTimeout(function(){t.close(!0)},300):e.length===i.length&&o())},!0),n.cancel=function(){t.dismiss("cancel")},n.getPinLength=function(){var e=i.length;return new Array(e)},n.onClickKeys=function(e){var t=(t=n.pin.toString()).concat(e);n.$evalAsync(function(){n.pin=t})}}angular.module("helium").controller("PinCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance"]}(),function(){"use strict";function e(s,a,t,e,n,i,l,r,o,u){var c,m,d,v,g,h=l.getMidnightTommorrow(),p=!1,f=0,b=null,H=a.Helium.settings;function E(e){for(var t=[],n=0;n<e;n++)t.push(void 0);return t=t.length?t:[void 0]}function S(e,t,n){var e=new Date(e),i=Math.round(e.getMinutes()/n)*n;return e.setMilliseconds(0),e.setSeconds(0),e.setMinutes(i),t<e&&e.setMinutes(e.getMinutes()-n),e}function M(e){for(var t,n=l.addMinutesToDate(e>s.reservation.now?e:s.reservation.now,s.cfg.maximumDuration),i=0,i=0;i<s.reservations.length;i++)if(s.reservations[i].dtStart>=e){t=s.reservations[i].dtStart;break}return t=t||l.getMidnightTommorrow(),t=new Date(Math.min(t.getTime(),n.getTime()))}s.focusEl=function(e,n){var i;a.$evalAsync(function(){s.activeTimeRoll.selected=e}),setTimeout(function(){var e,t;e=0,t=$(".reservation__container"),i=e=t.length?(b=b||t[0]).scrollHeight-b.clientHeight-10:e,f=f<i?i:f,f=n?0:f,$(b).animate({scrollTop:f},350)},250)},s.loading={state:!1,message:a.Helium.labels.reservation.loadingMessage,showErrorMessageTimeout:!1,responseReceived:!1},s.room=o,s.setNow=r,s.reservations=void 0!==o?[]:a.Helium.values.mainRoom.events,s.disableOrganizerEntry="Fusion"!==H.schedule.source&&"fusion"!==H.schedule.source&&"DEMO"!==H.schedule.source&&"Demo"!==H.schedule.source&&"demo"!==H.schedule.source,s.model={subject:"",organizer:"",startDate:null,endDate:null},s.cfg={step:H.reservation&&H.reservation.reserveNowMinDur?H.reservation.reserveNowMinDur:15,customTime:!!r&&H.schedule.reserveCustomEn},s.reservation={now:(g=r||new Date,c=r?r.getMinutes()%30:0,c=new Date(g.getTime()-(30==c?0:60*c*1e3)),g=function(e){var t;if(s.reservations&&s.reservations.length)for(var n=s.reservations.length-1;0<=n;n--)if(s.reservations[n].dtEnd<=e){t=s.reservations[n].dtEnd;break}return t||l.getMidnightToday()}(g),(c=new Date(Math.max((new Date).getTime(),c.getTime(),g.getTime()))).setMilliseconds(0),c.setSeconds(0),c),lockedStart:void 0===r,startRange:{options:null,value:0},endRange:{options:null,value:0},roomId:void 0!==o?o.id:null},s.cfg.maximumDuration=(g=120,H.reservation&&H.reservation.reserveNowMaxDur&&(g=H.reservation.reserveNowMaxDur),m=!r||(r&&angular.forEach(a.Helium.values.mainRoom.events,function(e){var t=e.dtStart-r;v=v||(0<t?t:v),0<t&&t<=v&&(v=t,d=e)}),g<(m=(m=d)?l.getTotalMinutesBetweenDates(s.reservation.now,m.dtStart):l.getTotalMinutesBetweenDates(s.reservation.now,h)))?g:m),s.onKeypress=function(e){var t,n;13===e.which&&(e.preventDefault(),t=(e=Array.prototype.slice.call($("input[type=text]"))).indexOf(document.activeElement),(n=e[t+1])&&!s.disableOrganizerEntry?n.focus():e[t]&&e[t].blur())},s.generateStartRange=function(){var n=s.cfg.step,i=s.reservation.now,e=M(i),t=l.getTotalMinutesBetweenDates(i,e),t=E(Math.min(s.cfg.maximumDuration,t)/n).map(function(e,t){return new Date(+i+t*n*60*1e3)}).filter(function(t){return!s.reservations.some(function(e){return t>=e.dtStart&&t<e.dtEnd||h<t})});s.cfg.customTime?(s.reservation.startRange.options=null,s.reservation.startRange.startDate=s.reservation.now,s.reservation.startRange.endDate=l.addMinutesToDate(e,-1),s.model.startDate=i):(s.reservation.startRange.options=t,s.reservation.startRange.value=s.reservation.startRange.options[0])},s.generateEndRange=function(){var n,i,a,e,t,o;s.model.startDate&&(n=s.cfg.step,i=H.reservation.reserveNowEvenEndTime,e=!r&&i?n-s.reservation.now.getMinutes()%n:0,a=new Date(s.model.startDate.getTime()+60*e*1e3),e=M(i?a:s.reservation.now),t=l.getTotalMinutesBetweenDates(a,e),o=E(Math.min(s.cfg.maximumDuration,t)/n).map(function(e,t){return i?new Date(+S(a,a,n)+t*n*60*1e3):new Date(+a+t*n*60*1e3)}).filter(function(t){return!(t<=s.model.startDate||s.reservations.some(function(e){return t>e.dtStart&&a<e.dtEnd||h<t}))}),t<=s.cfg.maximumDuration&&-1===o.indexOf(e)&&(i&&(e=S(e,e,n)),0<o.length&&e>o[o.length-1]||0===o.length)&&o.push(e),t=o,s.cfg.customTime&&!i?(o=l.getTotalMinutesBetweenDates(a,t[0]),s.reservation.endRange.options=null,s.reservation.endRange.startDate=l.addMinutesToDate(a,o),s.reservation.endRange.endDate=e,s.reservation.endRange.value=s.reservation.endRange.startDate,s.model.endDate=s.reservation.endRange.startDate):(s.reservation.endRange.options=t,s.reservation.endRange.value=t[0]))},s.$watch("model.startDate",function(){s.generateEndRange()}),s.generateStartRange(),s.activeTimeRoll={selected:null,setSelected:function(e){e===a.Helium.labels.reservation.starts&&s.reservation.lockedStart||(s.activeTimeRoll.selected=e)},isSelected:function(e){return s.activeTimeRoll.selected===e}},s.cancel=function(){s.room?(t.dismiss("cancel"),i.closeAll()):t.dismiss("cancel")},s.back=function(){function e(){t.dismiss("cancel")}s.reservation.roomId?($(".modal-reservation.slide-right").removeClass("modal-show"),setTimeout(e,350)):e()},s.add=function(){var e,t;p||(a.$evalAsync(function(){p=!1,s.loading.state=!0,angular.extend(a.Helium.state.loading,s.loading)}),e=setTimeout(function(){a.pendingReservation.prevRoomID=0},u.timeoutPendingRoom),t=setTimeout(function(){a.$evalAsync(function(){s.loading.responseReceived||(i.closeAll(),s.loading.showErrorMessageTimeout=!0,s.loading.state=a.Helium.state.loading.state=!1,a.Helium.methods.openMsgError("CreateEvent"),clearTimeout(e),a.pendingReservation.prevRoomID=0)})},u.timeoutLoadingMask),a.pendingReservation.prevRoomID=s.reservation.roomId,n.sendCreateEvent(!!s.setNow,s.reservation.roomId,s.model.subject||a.Helium.labels.reservation.defaultSubject,s.model.organizer||a.Helium.labels.reservation.defaultOrganizer,s.model.startDate,s.model.endDate,function(e){s.loading.showErrorMessageTimeout||(s.loading.responseReceived=!0,clearTimeout(t),a.$evalAsync(function(){s.loading.state=a.Helium.state.loading.state=!1,p=!1,i.closeAll(),e?!s.setNow&&s.room&&s.room.name&&a.Helium.methods.openMsgSuccess("CreateEvent"):(a.Helium.methods.openMsgError("CreateEvent"),a.pendingReservation.prevRoomID=0)}))}))},s.validReservation=function(){return s.model.startDate<s.model.endDate},s.isValidDate=function(e){return e&&e.getTime()===e.getTime()}}angular.module("helium").controller("ReservationCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance","TimelineService","CommunicationService","ModalService","DatetimeFactory","setNow","room","AppConfig"]}(),function(){"use strict";function e(n,i,e,a,t,o){function s(){n.currentTime=Date.now()}function l(){n.currentEvent=i.Helium.values.mainRoom.currentEvent,n.nextEvent=i.Helium.values.mainRoom.nextEvent}var r,u=!1;n.currentEvent=i.Helium.values.mainRoom.currentEvent,n.nextEvent=i.Helium.values.mainRoom.nextEvent,n.loading={state:!1,message:i.Helium.labels.checkInEvent?i.Helium.labels.checkInEvent.loadingMessage:""};function c(){var e=$(".menu__open");e[0].checked?e[0].checked=!1:e[0].checked=!0}function m(){var e=$(".menu__item--vision");i.Helium.state.vision?(e.addClass("bg__theme-color-6"),e.removeClass("bg__main-color-7")):(e.addClass("bg__main-color-7"),e.removeClass("bg__theme-color-6"))}i.$watch("Helium.values.mainRoom.currentEvent",function(){l()}),i.$watch("Helium.values.mainRoom.nextEvent",function(){l()}),i.$watch("Helium.state.roomOccupied",function(){}),i.$watch("Helium.settings.room.enableAvailableOccupiedState",function(){}),i.Helium.methods.setMenu(!0),n.currentTime=Date.now(),e.subscribe(s),n.openEventDetails=function(e){i.Helium.methods.openModal("details",{event:e})},n.checkInEvent=function(){function e(){n.checkIn()}var t=i.Helium.state.checkInEvent;!t.checkedIn&&i.Helium.state.needPin?(t=i.Helium.methods.openPin())&&t.result.then(function(){e()}):e()},n.checkIn=function(){var t=i.Helium.state.checkInEvent;t.checkedIn||u||(i.Helium.methods.closeMenu(),u=!0,n.loading.state=!0,angular.extend(i.Helium.state.loading,n.loading),a.sendCheckInEvent(t.id,t.instanceId,function(e){i.$evalAsync(function(){n.loading.state=i.Helium.state.loading.state=!1,u=!1,e?t.checkedIn=1:i.Helium.methods.openMsgError()})}))},n.endEvent=function(){i.Helium.state.setDisableEndNow()||i.Helium.methods.openEndEvent()},n.extendEvent=function(){i.Helium.state.setDisableExtendNow()||i.Helium.methods.openExtendEvent()},n.isCurrentEventEndingBeforeMidnightToday=function(){return i.Helium.values.mainRoom.currentEvent.dtEnd<o.getMidnightTommorrow()},n.setVision=function(){i.Helium.state.vision=!i.Helium.state.vision,t.updateTheme("impair-theme"),i.$evalAsync(function(){i.Helium.methods.closeMenu()}),m()},n.clickMenu=function(){c(),i.Helium.methods.openMenu();var e=$(".menu-close-label"),t=$(".menu__open__button");e.is(":visible")?($(".menu__item").css("visibility","visible"),t[0].setAttribute("style",""),t.css("border","0px")):t[0].setAttribute("style",""),r=setTimeout(function(){var e=$(".menu-close-label"),t=$(".menu-open-label");e.is(":visible")?$(".menu__item").css("visibility","visible"):t.is(":visible")&&$(".menu__item").delay(1).animate({visibility:"visible"},180,function(){$(".menu-close-label").is(":visible")&&$(".menu__item").css("visibility","visible")})},180)},$(".menu__item").css("visibility","hidden"),"vertical"!==i.Helium.state.layout&&"portrait"!==i.Helium.state.layout||$(".menu__open__button").css("background","transparent"),m(),$(".menu__open").on("click",function(){c()}),n.$on("$destroy",function(){e.unsubscribe(s),clearTimeout(r)})}angular.module("helium").controller("RoomCtrl",e),e.$inject=["$scope","$rootScope","AppClockService","CommunicationService","ThemeService","DatetimeFactory"]}(),function(){"use strict";function e(e,t,n,i){function a(){l=n(a,3e5),e.swapFields=!e.swapFields,e.firstSwap=!0}e.swapFields=!1,e.firstSwap=!1;function o(){e.currentTime=Date.now()}function s(){e.currentEvent=t.Helium.values.mainRoom.currentEvent||null,e.nextEvent=t.Helium.values.mainRoom.nextEvent||null}var l=n(a,3e5);e.currentTime=Date.now(),i.subscribe(o),e.goToRoom=function(){t.Helium.methods.openPage("room")},e.getLogo=function(){var e=t.Helium.settings.display.projectIconUrl;return e||""};t.$watch("Helium.values.mainRoom.currentEvent",function(){s()}),t.$watch("Helium.values.mainRoom.nextEvent",function(){s()}),e.$on("$destroy",function(){i.unsubscribe(o),n.cancel(l)})}angular.module("helium").controller("ScreensaverCtrl",e),e.$inject=["$scope","$rootScope","$timeout","AppClockService"]}(),function(){"use strict";function e(e,t,n,i){var a=setTimeout(function(){t.close()},n.successMsgCloseDelay);e.addEvent=i,e.cancel=function(){t.dismiss("cancel")},e.$on("$destroy",function(){clearTimeout(a)})}angular.module("helium").controller("SuccessMsgCtrl",e),e.$inject=["$scope","$uibModalInstance","AppConfig","addEvent"]}(),function(){"use strict";angular.module("helium").directive("hlmLoadingMask",function(){return{restrict:"A",replace:!0,scope:{loading:"=",message:"="},template:'<div class="loading bg__theme-color-6"><div class="loading__mask"><i class="loading__mask__img fa fa-spinner fa-pulse fa-3x fa-fw margin-bottom"></i><p class="loading__mask__message">{{ message }}</p></div></div>',link:function(e,t){e.$watch("loading",function(e){e?$(t).show():$(t).hide()})}}})}(),function(){"use strict";angular.module("helium").directive("helLongPressEl",function(){return{restrict:"A",replace:!1,scope:{duration:"@",callFnShort:"&",callFnLong:"&"},link:function(t,e){var n,i=!0;t.duration=t.duration||5e3,t.callFnShort=t.callFnShort||function(){},t.callFnLong=t.callFnLong||function(){},e[0].addEventListener("touchstart",function(){i=!1,n=setTimeout(function(){i=!0,t.callFnLong()},t.duration)},{passive:!0}),e[0].addEventListener("touchend",function(e){i||(clearTimeout(n),e.preventDefault(),t.callFnShort(e))})}}})}(),function(){"use strict";angular.module("helium").directive("scrollingPressEvent",function(){return{restrict:"A",replace:!0,scope:{scrollDirection:"@",scrollingPressEvent:"&",disablePress:"<"},link:function(n,e){function t(e){n.disablePress||(1<e.touches.length?s=!0:(s=!1,l(e),i.addEventListener("touchmove",u,{passive:!0}),i.addEventListener("touchend",c,{passive:!1})))}var i=e?e[0]:null,a={},o=30,s=!1,l=(n.scrollDirection=n.scrollDirection||"horizontal",n.scrollingPressEvent=n.scrollingPressEvent||function(){},function(e){(a={}).pageX=e.touches[0].pageX,a.pageY=e.touches[0].pageY,a.currentTarget=e.currentTarget,a.target=e.target}),r=function(){s||n.scrollingPressEvent()(a)},u=function(e){var t;n.disablePress||s||(1<e.touches.length?s=!0:(!n.scrollDirection||"vertical"!==n.scrollDirection&&"portrait"!==n.scrollDirection?(t=a?Math.abs(a.pageX-e.changedTouches.item(0).pageX):0,o<t&&(s=!0)):(t=a?Math.abs(a.pageY-e.changedTouches.item(0).pageY):0,o<t&&(s=!0)),s&&i.removeEventListener("touchmove",u,{passive:!0})))},c=function(e){n.disablePress||0<e.touches.length||(i.removeEventListener("touchmove",u,{passive:!0}),i.removeEventListener("touchend",c,{passive:!1}),s)||r()};i.addEventListener("touchstart",t,{passive:!0}),n.$on("destroy",function(){i.removeEventListener("touchstart",t,{passive:!0}),i.removeEventListener("touchmove",u,{passive:!0}),i.removeEventListener("touchend",c,{passive:!1})})}}})}(),function(){"use strict";angular.module("helium").directive("hlmScrollTouchEl",function(){return{restrict:"A",replace:!0,scope:{scrollDirection:"@",addClassName:"@",removeClassName:"@",childrenClassName:"@",childrenAddClassName:"@",childrenRemoveClassName:"@",disableInteraction:"<",enablePressAction:"<",callPressFn:"&"},link:function(a,o){function e(e){if(a.disableInteraction)r=!0,e.stopPropagation();else if(1<e.touches.length)r=!0;else if(s=r=!1,u(e),l.addEventListener("touchmove",m,{passive:!0}),l.addEventListener("touchend",d,{passive:!1}),$(o).removeClass(a.removeClassName),$(o).addClass(a.addClassName),a.childrenClassName)for(var t,n=$(o).children(),i=0;i<n.length;i++)if(-1!==n[i].className.indexOf(a.childrenClassName)){(t=$(n[i])).addClass(a.childrenAddClassName),t.removeClass(a.childrenRemoveClassName);break}}var s,l=o?o[0]:null,i={},n=30,r=!1,u=(a.scrollDirection=a.scrollDirection||"horizontal",a.addClassName=a.addClassName||"",a.removeClassName=a.removeClassName||"",a.childrenClassName=a.childrenClassName||"",a.childrenAddClassName=a.childrenAddClassName||"",a.childrenRemoveClassName=a.childrenRemoveClassName||"",a.callPressFn=a.callPressFn||function(){},function(e){(i={}).pageX=e.touches[0].pageX,i.pageY=e.touches[0].pageY,i.currentTarget=e.currentTarget,i.target=e.target}),c=function(){if(!s&&((s=!0)===a.enablePressAction&&!1===r&&a.callPressFn(i),$(o).hasClass(a.addClassName))&&($(o).removeClass(a.addClassName),$(o).addClass(a.removeClassName),a.childrenClassName))for(var e,t=$(o).children(),n=0;n<t.length;n++)if(-1!==t[n].className.indexOf(a.childrenClassName)){(e=$(t[n])).removeClass(a.childrenAddClassName),e.addClass(a.childrenRemoveClassName);break}},m=function(e){var t;a.disableInteraction||(!a.scrollDirection||"vertical"!==a.scrollDirection&&"portrait"!==a.scrollDirection?(t=i?Math.abs(i.pageX-e.changedTouches.item(0).pageX):0,n<t&&(r=!0)):(t=i?Math.abs(i.pageY-e.changedTouches.item(0).pageY):0,n<t&&(r=!0))),r&&(l.removeEventListener("touchmove",m,{passive:!0}),c())},d=function(e){a.disableInteraction||(l.removeEventListener("touchmove",m,{passive:!0}),l.removeEventListener("touchend",d,{passive:!1}),c(),r)||e.preventDefault()};l.addEventListener("touchstart",e,{passive:!0}),a.$on("destroy",function(){l.removeEventListener("touchstart",e,{passive:!0}),l.removeEventListener("touchmove",m,{passive:!0}),l.removeEventListener("touchend",d,{passive:!1})})}}})}(),function(){"use strict";angular.module("helium").directive("hlmShrinkToFit",function(){return{restrict:"A",replace:!1,scope:{string:"<",minSize:"<"},link:function(t,n){var o=function(e,t){var n=$(e),i=n.parent(),a=parseFloat(n.css("font-size"));t<a?n.get(0).scrollWidth>Math.ceil(i.width())&&(n.css("fontSize",a-1),o(e,t)):n.addClass("ellipsis")};t.minSize=t.minSize||24,t.$watch("string",function(e){e&&o(n,t.minSize)})}}})}(),function(){"use strict";function e(){}angular.module("helium").controller("SplashCtrl",e),e.$inject=[]}(),function(){"use strict";angular.module("helium").directive("hlmTimeRoll",function(){return{scope:{data:"=",label:"=",langArabic:"<",formatTime:"<",isSelected:"<"},restrict:"E",replace:!0,template:['<div class="time-roll border__theme-color-4"> <div style="display:none">{{data.value | date: formatTime}}</div><div class="time-roll__center border__theme-color-9"></div><div class="time-roll__top"></div><div class="time-roll__bottom"></div><div class="time-roll__viewport"><ul><li class="color__theme-color-6"><span></span></li><li class="color__theme-color-6" data-ng-repeat="value in data.options track by $index"><span data-ng-if="!langArabic" data-value="{{$index}}">{{formatTime ? (value | date: formatTime) : value}} {{label}}</span><span data-ng-if="langArabic" data-value="{{$index}}">{{label}} {{formatTime ? (value | date: formatTime) : value}} </span></li><li class="color__theme-color-6"><span></span></li></ul></div></div>'].join(""),link:function(t,n){var e,i=0,a=n.find(".time-roll__viewport"),o=a?a[0]:null,s=a.find("li").first().height(),l=s/2,r="time-roll__viewport__selected";function u(){return a.get(0).scrollTop}function c(e){$(e).addClass(r)}function m(){var e=n.find(".time-roll__viewport > ul li");$(e).removeClass(r)}function d(){var e=u();0===i&&(l<e%s?a.animate({scrollTop:e+s-e%s},100):a.animate({scrollTop:e-e%s},100))}function v(){var e=u(),e=l<e%s?(e+s-e%s)/s+2:(e-e%s)/s+2;m(),c(n.find(".time-roll__viewport > ul li:nth-child("+Math.round(e)+")")),t.data.value!==t.data.options[Math.round(e)-1-1]&&(t.data.value=t.data.options[Math.round(e)-1-1],t.$apply())}function g(){++i,clearTimeout(e)}t.$watch("data.options",function(){m();var e=0;e*=s,a.animate({scrollTop:e},300),c(n.find(".time-roll__viewport > ul li:nth-child(2)"))}),t.$watch("isSelected",function(){setTimeout(function(){var e=n.parent().find(".time-roll__viewport ul");e&&(e.css("display","none"),e.offset(),e.css("display",""))},100)}),a.bind("scroll",v),o&&o.addEventListener("touchstart",g,{passive:!0}),a.bind("touchend",function(){i=0,clearTimeout(e),e=setTimeout(d,700,void 0)})}}})}(),function(){"use strict";angular.module("helium").directive("hlmTouchEl",function(){return{restrict:"A",replace:!0,scope:{addClassName:"@",removeClassName:"@",childrenClassName:"@",childrenAddClassName:"@",childrenRemoveClassName:"@",disableInteraction:"<",enablePressAction:"<",enableLongPressAction:"<",duration:"@",callFnShort:"&",callFnLong:"&"},link:function(a,o){var s,l=!0,e=o?o[0]:null,t=(a.addClassName=a.addClassName||"",a.removeClassName=a.removeClassName||"",a.childrenClassName=a.childrenClassName||"",a.childrenAddClassName=a.childrenAddClassName||"",a.childrenRemoveClassName=a.childrenRemoveClassName||"",a.duration=a.duration||2e3,a.enableLongPressAction=a.enableLongPressAction||!1,a.callFnShort=a.callFnShort||function(){},a.callFnLong=a.callFnLong||function(){},function(i){e.removeEventListener("touchend",t,{passive:!1}),!0!==a.disableInteraction&&window.requestAnimationFrame(function(){if($(o).removeClass(a.addClassName),$(o).addClass(a.removeClassName),a.childrenClassName)for(var e,t=$(o).children(),n=0;n<t.length;n++)if(-1!==t[n].className.indexOf(a.childrenClassName)){(e=$(t[n])).removeClass(a.childrenAddClassName),e.addClass(a.childrenRemoveClassName);break}!0!==a.enablePressAction||l||(clearTimeout(s),a.callFnShort(i))})});e.addEventListener("touchstart",function(){e.addEventListener("touchend",t,{passive:!1}),!0!==a.disableInteraction&&window.requestAnimationFrame(function(){if($(o).removeClass(a.removeClassName),$(o).addClass(a.addClassName),a.childrenClassName)for(var e,t=$(o).children(),n=0;n<t.length;n++)if(-1!==t[n].className.indexOf(a.childrenClassName)){(e=$(t[n])).addClass(a.childrenAddClassName),e.removeClass(a.childrenRemoveClassName);break}!0===a.enablePressAction&&(l=!1,s=setTimeout(function(){!0===a.enableLongPressAction&&(l=!0,a.callFnLong())},a.duration))})},{passive:!0})}}})}(),function(){"use strict";angular.module("helium").directive("elTouchEnd",function(){return{restrict:"A",replace:!1,scope:{touchEndFn:"&"},link:function(e,t){t=t?t[0]:null;e.touchEndFn=e.touchEndFn||function(){};t.addEventListener("touchend",function(){e.$apply(function(){e.$eval(e.touchEndFn)})},{passive:!1})}}})}(),function(){"use strict";angular.module("helium").directive("hlmVideoPoster",function(){return{restrict:"A",replace:!0,scope:{hlmVideoPoster:"="},link:function(e,t){e.$watch("hlmVideoPoster",function(e){e&&t.attr("poster",e)}),e.hlmVideoPoster=e.hlmVideoPoster||"",t.attr("poster",e.hlmVideoPoster)}}})}(),function(){"use strict";angular.module("helium").factory("DatetimeFactory",function(){return this.getMidnightToday=function(){var e=new Date;return e.setHours(0,0,0,0),e},this.getMidnightTommorrow=function(){var e=new Date;return e.setHours(24,0,0,0),e},this.isNowBetweenDates=function(e,t){var n=new Date;return e<n&&n<=t},this.getRoundTimeLeftTill=function(e){var t=(new Date).getTime();return this.getTimeLeftBetweenDates(e,t-6e4)},this.getTimeLeftTill=function(e){var t=(new Date).getTime();return this.getTimeLeftBetweenDates(e,t)},this.getTotalMinutesBetweenDates=function(e,t){var n=e%6e4,i=t%6e4,n=(n&&0!=n&&(e-=n),i&&0!=i&&(t-=i),Math.abs(t-e)/1e3);return Math.floor(n/60)},this.getTimeLeftBetweenDates=function(e,t){var e=Math.abs(e-t)/1e3,t=Math.floor(e/3600)%24,n=(e-=3600*t,Math.floor(e/60)%60);return{hours:t,minutes:n,seconds:(e-=60*n)%60}},this.addMinutesToDate=function(e,t){return new Date(e.getTime()+6e4*t)},this.isDateBeforeDate=function(e,t){return e<=t},this})}(),function(){"use strict";angular.module("helium").factory("UtilFactory",function(){return this.getControllerModal=function(e){for(var t=e?e.split("-"):[],n="",i=0;i<t.length;i++)n+=this.capitalizeFirstLetter(t[i]);return n&&n+"Ctrl"},this.capitalizeFirstLetter=function(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)},this.isString=function(e){return"string"==typeof e||e instanceof String},this.existClass=function(){return!0},this.existsTemplate=function(){return!0},this})}(),function(){"use strict";function e(i,e,t,n,a,o,s){function l(){e.stopScreensaverTimeout(),n[0].addEventListener("touchend",u,{passive:!1}),n[0].addEventListener("touchcancel",u,{passive:!1})}var r=!1,u=(e.listenForActions(),e.createMethods(),t.path("page/splash"),o.loadTheme(),s.loadLayout(),e.setTimelineBlockDimensions(),function(){e.startScreensaverTimeout(),n[0].removeEventListener("touchend",u,{passive:!1}),n[0].removeEventListener("touchcancel",u,{passive:!1})});i.$on("$locationChangeStart",function(){r=!0,a.closeAll(),i.Helium.state.loading.state=!1}),i.$on("$routeChangeSuccess",function(){r||a.closeAll(),r=!1}),i.$on("$routeChangeError",function(e,t,n){i.Helium.methods.openPage(n.params.page)}),n[0].addEventListener("touchstart",l,{passive:!0}),i.$on("destroy",function(){n[0].removeEventListener("touchstart",l,{passive:!0}),n[0].removeEventListener("touchend",u,{passive:!1}),n[0].removeEventListener("touchcancel",u,{passive:!1})})}angular.module("helium").run(e),e.$inject=["$rootScope","AppStateService","$location","$document","ModalService","ThemeService","LayoutService"]}(),function(){"use strict";function e(n){function i(){s&&(n.cancel(a),s=!1)}var a,o=[],s=!1,l=function(){for(var e=0;e<o.length;e++)try{o[e]()}catch(e){console.log("AppClockService: Exception while processing a callback function: "+e)}},r=function(){l();var e=60500-(new Date).getTime()%6e4;a=n(r,e)};this.subscribe=function(e){var t;o.length||(s&&i(),l(),t=60500-(new Date).getTime()%6e4,a=n(r,t),s=!0),o.push(e)},this.unsubscribe=function(e){for(var t=o.length;0<=t;t--)if(o[t]===e){o.splice(t,1);break}o.length||i()}}angular.module("helium").service("AppClockService",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(u,t,r,c,m,n,d,e,i,a,o,v,s,l,g){var h,p=this,f={config:!1,providerStatus:!1},b=!1;function H(){var e=u.Helium.state.buttons.disable,t=u.Helium.state.isOnline;u.Helium.state.setVisibleEndNow(),u.Helium.state.setVisibleExtendNow(),u.Helium.state.setVisibleCheckInNow(),u.Helium.state.setDisableEndNow(),u.Helium.state.setDisableExtendNow(),u.Helium.state.setDisableCheckIn(),e.findRoom=!t,e.reserveNow=!t}function E(){H(),u.Helium.state.setRoomReserved()}u.Helium={methods:{},language:{},settings:{countDownScreenSaver:a.screenSaverDelay,schedule:{source:""},room:{enableAvailableOccupiedState:!0}},settingsExtra:{supportsInstanceManipulation:!1,readOnlyModeEnabled:!1},labels:{},values:{mainRoom:{events:[],currentEvent:null,nextEvent:null}},state:{layout:"",portraitPanel:!1,countOpenModals:0,modalOpen:!1,help:!1,loading:{state:!1,message:"Loading"},isOnline:!0,roomOccupied:!1,isArabic:!1,buttons:{disable:{}},needPin:!1,checkInEvent:null,openAbout:!1,refreshingProvider:!1,timelineBlockHorizontalSize:322,timelineBlockVerticalSize:113}},u.pendingReservation={prevRoomID:0},g.subscribe(function(){console.log("AppStateService: Clock update"),E()}),u.$watch("Helium.values.mainRoom.currentEvent",E),u.$watch("Helium.values.mainRoom.currentEvent.privacyLevel",E),u.$watch("Helium.values.mainRoom.nextEvent",E),u.$watch("Helium.values.mainRoom.currentEvent.checkedIn",H),u.$watch("Helium.values.mainRoom.nextEvent.checkedIn",E),u.$watch("Helium.state.isOnline",H),u.$watch("Helium.values.mainRoom.currentEvent.dtEnd",H),u.$watch("Helium.values.mainRoom.nextEvent.dtStart",E),this.setTimelineBlockDimensions=function(){var e=window.screen?window.screen.width:0,t=window.screen?window.screen.height:0,e=e<=t,n=322,i=113;if(u.Helium.state.portraitPanel=e)switch(t){case 1280:n=322,i=113;break;case 640:n=160,i=70}else switch(t){case 800:case 739:n=322,i=113;break;case 363:case 360:n=160,i=68}u.Helium.state.timelineBlockHorizontalSize=n,u.Helium.state.timelineBlockVerticalSize=i},this.listenForActions=function(){function t(){f.config&&f.providerStatus&&e(function(){b=!0,u.Helium.methods.openPage("room"),u.Helium.settings.display.disableIdleScreen?(console.log("AppStateService: Received action: Idle screen disabled. Stop timeout operation"),p.stopScreensaverTimeout()):(console.log("AppStateService: Received action: Idle screen enabled. Start timeout operation"),p.startScreensaverTimeout())},2e3)}i.listenForProviderStatus(function(e){f.providerStatus=!0,u.$evalAsync(function(){u.Helium.state.vision=!1,o.applyProviderState(e),t(),l.applyBackground()})}),i.listenForTimeline(function(e){u.$evalAsync(function(){d.applyRoomTimeline(e.data)})}),i.listenForEvents(function(e){u.$evalAsync(function(){d.applyRoomEvents(e.data)})}),i.listenForConfig(function(e){u.$evalAsync(function(){console.log("AppStateService: Received config: display.disableIdleScreen: "+e.data.settings.display.disableIdleScreen),u.Helium.state.vision=!1,f.config=!0,n.changeLanguage(e.data.settings.room,function(){o.applySettings(e.data),E(),o.setNeedsPin(e.data),o.isFirstInitialization()&&(e.data.settings.display.disableIdleScreen?(console.log("AppStateService: Received config: Idle screen disabled. Stop timeout operation"),p.stopScreensaverTimeout()):(console.log("AppStateService: Received config: Idle screen enabled. Start timeout operation"),p.startScreensaverTimeout())),t(),l.applyBackground()}),d.refreshStateOnCurrentMeeting()})})},this.createMethods=function(){var l=!(u.Helium.methods.openPage=function(e){b&&t.path("/page/"+e)});function i(){var e,t=u.Helium.values.mainRoom.nextEvent,n=u.Helium.settings.automation&&u.Helium.settings.automation.forceOrgCheckInMin;return t?(e=new Date,e=v.getTotalMinutesBetweenDates(e,t.dtStart),n&&angular.isNumber(n)&&e<=n?(t.state.visibleCheckInNow=!0,u.Helium.state.checkInEvent=t,!0):(t.state.visibleCheckInNow=!1,u.Helium.state.checkInEvent=null,!1)):(u.Helium.state.checkInEvent=null,!1)}u.Helium.methods.openModal=function(e,t,n){var i,a,o,s;if(console.log("AppState: openModal called: "+e),!l)return i=m.getControllerModal(e),a=c.getModalTemplateUrl(e),o=$("main"),u.Helium.methods.closeMenu(),m.existClass(i)&&a&&(l=!0,setTimeout(function(){l=!1},250),(s=r.open(angular.extend({animation:!0,backdrop:"static",keyboard:!1,templateUrl:a,controller:i,windowClass:"modal-"+e,resolve:t||{}},n))).opened.then(function(){u.Helium.state.countOpenModals++,o.addClass("blur"),u.Helium.state.modalOpen=!0}),s.closed.then(function(){u.Helium.state.countOpenModals--,u.Helium.state.countOpenModals<1&&(o.removeClass("blur"),u.Helium.state.modalOpen=!1,u.Helium.state.countOpenModals<0)&&(u.Helium.state.countOpenModals=0)})),s;console.log("AppState: openModal: "+e+". Already working on previous request. Return")},u.Helium.methods.openEndEvent=function(){console.log("AppState: openEndEvent called;");function e(){u.Helium.methods.openModal("end-event").result.catch(function(e){if(-1===["cancel","backdrop click","escape key press"].indexOf(e))throw e})}var t;u.Helium.state.needPin?(t=u.Helium.methods.openPin())&&t.result.then(function(){e()}):e()},u.Helium.methods.openExtendEvent=function(){console.log("AppState: openExtendEvent called;");function e(){u.Helium.values.mainRoom.currentEvent.state.maxExtend&&u.Helium.methods.openModal("extend-event").result.catch(function(e){if(-1===["cancel","backdrop click","escape key press"].indexOf(e))throw e})}var t;u.Helium.state.needPin?(t=u.Helium.methods.openPin())&&t.result.then(function(){e()}):e()},u.Helium.methods.closeHelp=function(){console.log("AppState: closeHelp called;"),u.$evalAsync(function(){u.Helium.state.help=!1})},u.Helium.methods.openHelp=function(){console.log("AppState: openHelp called;");u.Helium.methods.closeMenu(),u.$evalAsync(function(){u.Helium.state.help=!0}),setTimeout(function(){document.addEventListener("touchend",u.Helium.methods.closeHelp)},10)},u.Helium.methods.openReservation=function(t,n){var e=u.Helium.settings.room,i=u.Helium.values.mainRoom;if(t&&u.Helium.state.isReserved()&&e&&e.availabilityThresholdRoomState&&v.isDateBeforeDate(t,i.currentEvent.dtStart)&&v.getTotalMinutesBetweenDates(t,i.currentEvent.dtStart)<=e.availabilityThresholdMin)return console.log("AppState: Cannot create new reservation at the selected time. Within Availability Threshold of next meeting"),!1;function a(){var e;u.Helium.state.isOnline&&((e=u.Helium.methods.openModal("reservation",{setNow:function(){return t},room:function(){return n}},n?{windowClass:"modal-reservation slide-right",animation:!1}:{})).result.catch(function(e){if(-1===["cancel","backdrop click","escape key press","undefined"].indexOf(e))throw e}),n)&&e.rendered.then(function(){$(".modal-reservation.slide-right").addClass("modal-show")})}!n&&u.Helium.state.needPin?(i=u.Helium.methods.openPin())&&i.result.then(function(){a()}):a()},u.Helium.methods.openFindRoom=function(){function e(){u.Helium.methods.openModal("find-room").result.catch(function(e){if(-1===["cancel","backdrop click","escape key press"].indexOf(e))throw e})}var t;u.Helium.state.needPin?(t=u.Helium.methods.openPin())&&t.result.then(function(){e()}):e()},u.Helium.methods.openAbout=function(){u.Helium.methods.closeHelp(),u.Helium.methods.closeMenu();var e=u.Helium.methods.openModal("about");e.opened.then(function(){u.Helium.state.openAbout=!0}),e.closed.then(function(){u.Helium.state.openAbout=!1}),e.result.catch(function(e){if(-1===["cancel","backdrop click","escape key press"].indexOf(e))throw e})},u.Helium.methods.openMsgError=function(e){u.Helium.methods.openModal("error-msg",{addEvent:function(){return e}}).result.catch(function(e){if(-1===["cancel","backdrop click","escape key press"].indexOf(e))throw e})},u.Helium.methods.openMsgSuccess=function(e){u.Helium.methods.openModal("success-msg",{addEvent:function(){return e}}).result.catch(function(e){if(-1===["cancel","backdrop click","escape key press"].indexOf(e))throw e})},u.Helium.methods.openPin=function(){return!!u.Helium.state.isOnline&&u.Helium.methods.openModal("pin",null,{backdropClass:"modalOpacity",backdrop:"true"})},this.startScreensaverTimeout=function(){e.cancel(h),u.Helium.settings.display&&u.Helium.settings.display.disableIdleScreen?console.log("AppStateService: Idle screen disabled. Do not start timeout operation"):h=e(function(){u.Helium.state.vision=!1,s.loadTheme(),u.Helium.methods.openPage("screensaver")},u.Helium.settings.countDownScreenSaver)},this.stopScreensaverTimeout=function(){e.cancel(h)},this.setRefreshProviderTimeout=function(){u.Helium.state.refreshingProvider=!0,setTimeout(function(){u.Helium.state.refreshingProvider=!1},3e4)},u.Helium.methods.openMenu=function(){var e=$(".menu__open"),t=$(".menu__overlay");e.length&&e.is(":checked")?(u.Helium.methods.setMenu(!1),t.length&&t.addClass("menu__overlay--display")):(u.Helium.methods.setMenu(!0),t.removeClass("menu__overlay--display"))},u.Helium.methods.closeMenu=function(){var e=$(".menu__open"),t=$(".menu__overlay");e.length&&e.is(":checked")&&(e.prop("checked",!1),t.length)&&t.removeClass("menu__overlay--display"),u.Helium.methods.setMenu(!0)},u.Helium.methods.setMenu=function(e){var t,n;t=e,n=$(".menu__open__button"),t?n.removeClass("bg__main-color-8"):n.addClass("bg__main-color-8"),setTimeout(function(){u.Helium.methods.setMenuItemVisibility(e)},180)},u.Helium.methods.setMenuItemVisibility=function(e){var t=$(".menu__open__button"),n=$(".menu-close-label"),i=$(".menu__item");e?i.delay(1).animate({visibility:"hidden"},0,function(){n.is(":visible")?window.requestAnimationFrame(function(){i.css("visibility","visible"),t.css("border","0")}):(i.css("visibility","hidden"),window.requestAnimationFrame(function(){t[0].setAttribute("style",""),"vertical"!==u.Helium.state.layout&&"portrait"!==u.Helium.state.layout||t[0].setAttribute("style","background: transparent")}))}):"vertical"!==u.Helium.state.layout&&"portrait"!==u.Helium.state.layout||window.requestAnimationFrame(function(){i.css("visibility","visible"),t[0].setAttribute("style",""),t.css("border","0")})},u.Helium.state.isReserved=function(){return d.isReserved()},u.Helium.state.isAvailable=function(){return d.isAvailable()},u.Helium.state.isAvailableForTheRestOfTheDay=function(){return d.isAvailableForTheRestOfTheDay()},u.Helium.state.isOccupied=function(){return u.Helium.state.roomOccupied},u.Helium.state.getRemainingTimeString=function(e){var t=new Date,t=v.getTimeLeftBetweenDates(t,e.dtEnd),e="";return t&&0<t.hours&&(e=(e=(e+=t.hours+" ")+(1<t.hours?u.Helium.labels.hours:u.Helium.labels.hour))+" "+u.Helium.labels.and+" "),e=(e+=t.minutes+1+" ")+(1<t.minutes?u.Helium.labels.minutes:u.Helium.labels.minute)},u.Helium.state.setVisibleEndNow=function(){if(!u.Helium.settingsExtra.readOnlyModeEnabled){var e=u.Helium.settings.reservation&&u.Helium.settings.reservation.endEarlyType,t=u.Helium.values.mainRoom?u.Helium.values.mainRoom.currentEvent:null;if(null!==t&&(!t||u.Helium.settingsExtra.supportsInstanceManipulation||!t.isRecurring)){if(u.Helium.settings.room&&u.Helium.settings.room.availabilityThresholdRoomState||u.Helium.settings.display&&u.Helium.settings.display.reservedColorForCheckedIn){var n=u.Helium.values.mainRoom?u.Helium.values.mainRoom.nextEvent:null;if(n&&t&&n.id===t.id)return t.state.visibleEndNow=!1}if(u.Helium.state.isReserved()&&e&&"off"!==e.toLowerCase()){var n=new Date,i=v.getTotalMinutesBetweenDates(t.dtStart,t.dtEnd),n=n>t.dtStart?v.getTotalMinutesBetweenDates(t.dtStart,n):0;if("minutes"===e.toLowerCase()){var a=u.Helium.settings.reservation.freeUpRoomEnMin;if(angular.isNumber(a)&&a<=n)return t.state.visibleEndNow=!0}else if("percentage"===e.toLowerCase()){var o,a=u.Helium.settings.reservation.freeUpRoomEnPer;if(angular.isNumber(a)&&(o=a/100*i),angular.isNumber(o)&&o<=n)return t.state.visibleEndNow=!0}}t.state.visibleEndNow=!1}}return!1},u.Helium.state.setDisableEndNow=function(){var e=u.Helium.state.buttons.disable,t=u.Helium.state.isOnline,n=!1,n=(u.Helium.values.mainRoom.currentEvent&&!u.Helium.settingsExtra.supportsInstanceManipulation&&u.Helium.values.mainRoom.currentEvent.isRecurring&&(n=!0),t?n:!t);return e.end=n},u.Helium.state.setVisibleExtendNow=function(){if(!u.Helium.settingsExtra.readOnlyModeEnabled){var e=u.Helium.settings.reservation,t=e&&e.extendReservationType,n=u.Helium.values.mainRoom?u.Helium.values.mainRoom.currentEvent:null;if(null!==n&&(!n||u.Helium.settingsExtra.supportsInstanceManipulation||!n.isRecurring)){if(u.Helium.settings.room&&u.Helium.settings.room.availabilityThresholdRoomState||u.Helium.settings.display&&u.Helium.settings.display.reservedColorForCheckedIn){var i=u.Helium.values.mainRoom?u.Helium.values.mainRoom.nextEvent:null;if(i&&n&&i.id===n.id)return n.state.visibleExtendNow=!1}if(u.Helium.state.isReserved()&&t&&"off"!==t.toLowerCase()){var i=new Date,a=v.getTotalMinutesBetweenDates(n.dtEnd,n.dtStart),o=a-(i>n.dtStart?Math.round(v.getTotalMinutesBetweenDates(n.dtStart,i)):0),i=function(e){return n.state.visibleExtendNow=!(o<=0)&&o<=e};if("minutes"===t.toLowerCase())return i(angular.isNumber(e.extendReservationMinAfter)?e.extendReservationMinAfter:0);if("percentage"===t.toLowerCase())return t=angular.isNumber(e.extendReservationPerAfter)?e.extendReservationPerAfter:0,i(Math.max(1,Math.round(t/100*a)))}n.state.visibleExtendNow=!1}}return!1},u.Helium.state.setDisableExtendNow=function(){var e=u.Helium.state.buttons.disable,t=u.Helium.state.isOnline,n=!1,i=u.Helium.values.mainRoom.currentEvent,a=u.Helium.values.mainRoom.nextEvent,o=a&&i?v.getTotalMinutesBetweenDates(i.dtEnd,a.dtStart):-1;return(i&&!u.Helium.settingsExtra.supportsInstanceManipulation&&i.isRecurring||a&&i&&0===o)&&(n=!0),e.extend=t?n:!t,e.extend},u.Helium.state.setVisibleCheckInNow=function(){var e,t,n;return u.Helium.settings.automation&&u.Helium.settings.automation.forceOrgCheckIn?u.Helium.state.isReserved()?(e=u.Helium.values.mainRoom.currentEvent,t=(t=new Date)>e.dtStart?v.getTotalMinutesBetweenDates(e.dtStart,t):-1,(n=u.Helium.settings.automation.forceOrgCheckInEndMin)&&angular.isNumber(n)&&0<=t&&t<n?(e.state.visibleCheckInNow=!0,u.Helium.state.checkInEvent=e,!0):i()?!(e.state.visibleCheckInNow=!1):(e.state.visibleCheckInNow=!1,u.Helium.state.checkInEvent=null,!1)):u.Helium.state.isAvailable()?i():void 0:(u.Helium.state.checkInEvent=null,!1)},u.Helium.state.setDisableCheckIn=function(){var e=u.Helium.state.buttons.disable,t=u.Helium.state.isOnline,n=u.Helium.values.mainRoom,i=!1;return n.currentEvent&&n.currentEvent.state.visibleCheckInNow?i=n.currentEvent.checkedIn:n.nextEvent&&n.nextEvent.state.visibleCheckInNow&&(i=n.nextEvent.checkedIn),e.checkIn=!t||i,e.checkIn},u.Helium.state.setRoomReserved=function(){var e=u.Helium.settings,t=e.room&&e.room.availabilityThresholdRoomState,n=e.room&&e.room.availabilityThresholdMin?e.room.availabilityThresholdMin:0,i=!1,a=0,o=e.automation&&e.automation.forceOrgCheckIn,o=(o&&(a=e.automation&&e.automation.forceOrgCheckInMin?e.automation.forceOrgCheckInMin:0),o&&e.display&&e.display.reservedColorForCheckedIn),e=!1,s=(new Date).getTime(),l=u.Helium.values.mainRoom.currentEvent,r=u.Helium.values.mainRoom.nextEvent,s=r?v.getTotalMinutesBetweenDates(s,r.dtStart):v.getTotalMinutesBetweenDates(s,v.getMidnightTommorrow());return t&&angular.isNumber(n)&&s<=n&&(console.log("AppStateService: setRoomReserved: Within Availability Thrershold"),i=!0),o&&angular.isNumber(a)&&s<=a&&r&&r.checkedIn&&(console.log("AppStateService: setRoomReserved: Next event checked in"),e=!0),u.Helium.state.isAvailable()?(i||e)&&(console.log("AppStateService: setRoomReserved: Availability Threshold State active or Next Meeting is Checked In. Set reserved"),d.setCurrentEvent(r)):u.Helium.state.isReserved()&&r&&l&&r.id===l.id&&(i||e||(console.log("AppStateService: setRoomReserved: Availability Threshold State NOT active or enabled, and Reserved State for Checked In NOT active or enabled. Set available"),d.setCurrentEvent(null))),!1}}}angular.module("helium").service("AppStateService",e),e.$inject=["$rootScope","$location","$uibModal","templateService","UtilFactory","LocalizationService","TimelineService","$timeout","CommunicationService","AppConfig","SettingsService","DatetimeFactory","ThemeService","BackgroundService","AppClockService"]}(),function(){"use strict";function e(n){function i(e){m(),angular.extend(s,{video:"",type:"",poster:""}),angular.extend(o,{src:e})}function a(e){d(),angular.extend(r,{video:"",type:"",poster:""}),angular.extend(l,{src:e})}var o,s,l,r,u="",c=function(){n.Helium.state.theme&&(u="assets/images/"+n.Helium.state.theme+".png"),u=n.Helium.state.vision?"assets/images/dark-theme.png":u},m=function(){n.Helium.settings.screenSaverBg||(n.Helium.settings.screenSaverBg={img:{},media:{}}),o=n.Helium.settings.screenSaverBg.img,s=n.Helium.settings.screenSaverBg.media},d=function(){n.Helium.settings.roomBg||(n.Helium.settings.roomBg={img:{},media:{}}),l=n.Helium.settings.roomBg.img,r=n.Helium.settings.roomBg.media};function t(e){var t;"image"===e.mediaType.toLowerCase()?i(e.url):"video"===e.mediaType.toLowerCase()&&(e=e,t=document.getElementsByClassName("screensaver__video"),m(),c(),angular.extend(o,{src:""}),angular.extend(s,{video:e.url,type:e.mediaSubType,poster:u}),t.length)&&t[0].load()}function v(e){var t;"image"===e.mediaType.toLowerCase()?a(e.url):"video"===e.mediaType.toLowerCase()&&(e=e,t=document.getElementsByClassName("room__video"),d(),c(),n.Helium.settings.roomBg.img.src="",angular.extend(l,{src:""}),angular.extend(r,{video:e.url,type:e.mediaSubType,poster:u}),t.length)&&t[0].load()}this.applyBackground=function(){this.setBackground()},this.setBackground=function(){var e=n.Helium.settings.display,e=e?e.backgrounds:null;angular.isObject(e)?(i("assets/images/bg.jpg"),a("assets/images/bg.jpg"),n.Helium.state.isReserved()?(e.reservedActive&&e.reservedActive.enabled&&v(e.reservedActive),e.reservedIdle&&e.reservedIdle.enabled&&t(e.reservedIdle)):n.Helium.state.roomOccupied?(e.availableActiveOccupied&&e.availableActiveOccupied.enabled?v(e.availableActiveOccupied):e.availableActive&&e.availableActive.enabled&&v(e.availableActive),e.availableIdleOccupied&&e.availableIdleOccupied.enabled?t(e.availableIdleOccupied):e.availableIdle&&e.availableIdle.enabled&&t(e.availableIdle)):(e.availableActive&&e.availableActive.enabled&&v(e.availableActive),e.availableIdle&&e.availableIdle.enabled&&t(e.availableIdle))):(i("assets/images/bg.jpg"),a("assets/images/bg.jpg"))}}angular.module("helium").service("BackgroundService",e),e.$inject=["$rootScope"]}(),function(){"use strict";angular.module("helium").service("CommunicationService",function(){function l(e){function t(){r.unsubscribe.data.timeline(t),r.unsubscribe.data.providerStatus(t),e()}r.subscribe.data.timeline(t,!1),r.subscribe.data.providerStatus(t,!1)}var r=SchedulingPanel.webUI;this.listenForConfig=function(e){r.subscribe.data.config(e)},this.listenForLanguage=function(e){r.subscribe.data.language(e)},this.listenForTimeline=function(e){r.subscribe.data.timeline(e)},this.listenForProviderStatus=function(e){r.subscribe.data.providerStatus(e)},this.listenForEvents=function(e){r.subscribe.data.events(e)},this.sendExtendEvent=function(e,t,n,i){r.send.action.extendEvent(e.toString(),null===t?null:t.toString(),n.toString(),function(e,t){e?l(function(){i(e,t)}):i(e,t)})},this.sendEndEvent=function(e,t,n){r.send.action.endEvent(e.toString(),null===t?null:t.toString(),function(e,t){e?l(function(){n(e,t)}):n(e,t)})},this.sendCreateEvent=function(e,n,t,i,a,o,s){r.send.action.createEvent(e,null===n?null:n.toString(),t.toString(),i.toString(),a.getTime(),o.getTime(),function(e,t){e&&null===n?l(function(){s(e,t)}):s(e,t)})},this.sendRoomSearch=function(e,t){r.send.action.roomSearch(e.toString(),t)},this.sendDetailsEvent=function(e,t,n){r.send.action.detailsEvent(e.toString(),null===t?null:t.toString(),n)},this.sendCheckInEvent=function(e,t,n){r.send.action.checkInEvent(e.toString(),null===t?null:t.toString(),n)},this.sendOpenSettings=function(){r.send.action.openSettings()},this.sendAbout=function(e){r.send.action.statusScreenInfo(e)},this.sendRefreshSchedule=function(e){r.send.action.refreshSchedule(e)}})}(),function(){"use strict";function e(t){this.updateLayout=function(e){e=e?"vertical":"horizontal";t.Helium.state.portraitPanel&&(e="portrait"),t.Helium.state.layout=e,localStorage.setItem("layout",e)},this.loadLayout=function(){t.Helium.state.layout=localStorage.getItem("layout")||"horizontal"}}angular.module("helium").service("LayoutService",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(o,s,t,l,r){var u;function c(e){o.Helium.labels=e}function m(e){return t.get("assets/translations/"+e+".json")}this.changeLanguage=function(e,t){function n(){s.set(i),l.arabicLanguage="iw"===i||"he"===i||"ar"===i,o.Helium.state.isArabic=l.arabicLanguage,o.isRtl=a}var i=e.language,a=e.rtl;m(i=(i=i||"en-us").toLowerCase().split("_").join("-")).then(function(e){u=i,n(),c(e.data),r.reload(),t()},function(){m(u||"en-us").then(function(e){n(),c(e.data),r.reload(),t()},function(){t()})})}}angular.module("helium").service("LocalizationService",e),e.$inject=["$rootScope","tmhDynamicLocale","$http","AppConfig","$route"]}(),function(){"use strict";function e(e){this.closeAll=function(){e.dismissAll()}}angular.module("helium").service("ModalService",e),e.$inject=["$uibModalStack"]}(),function(){"use strict";function e(n,i,a,o){var s,l=0;this.isFirstInitialization=function(){return 1===l},this.applySettings=function(e){if(e){var t=e.settings.room;switch(t.timeFormat?(t.timeFormat="h:mm a",t.hoursFormat="h",t.hoursAmpmFormat="h a",t.ampmFormat="a"):(t.timeFormat="HH:mm",t.hoursFormat="HH",t.hoursAmpmFormat="HH",t.ampmFormat=""),t.minutesFormat="mm",t.dateFormat){case"WMDY":t.dateFormat=n.Helium.state.isArabic?" y, EEEE, dd MMMM":"EEEE, MMMM dd, y";break;case"WDMY":t.dateFormat=n.Helium.state.isArabic?"EEEE, y-MMMM-dd":"EEEE, dd-MMMM-y";break;case"WYMD":t.dateFormat=n.Helium.state.isArabic?"EEEE, dd-MMMM-y":"EEEE, y-MMMM-dd";break;case"WMD":t.dateFormat=n.Helium.state.isArabic?"EEEE, dd MMMM":"EEEE, MMMM dd";break;case"WDM":t.dateFormat=n.Helium.state.isArabic?"EEEE, MMMM-dd":"EEEE, dd-MMMM";break;case"MDY":t.dateFormat=n.Helium.state.isArabic?"y, dd MMMM":"MMMM dd, y";break;case"DMY":t.dateFormat=n.Helium.state.isArabic?"y-MMMM-dd":"dd-MMMM-y";break;case"YMD":t.dateFormat=n.Helium.state.isArabic?"dd-MMMM-y":"y-MMMM-dd";break;case"M.DY":t.dateFormat=n.Helium.state.isArabic?"y dd MMMM":"MMMM.dd y";break;case"D.MY":t.dateFormat=n.Helium.state.isArabic?"y MMMM.dd":"dd.MMMM y";break;default:t.dateFormat=n.Helium.state.isArabic?"EEEE, y, dd MMMM":"fullDate"}s=e,n.Helium.settings=angular.extend({},s.settings,{countDownScreenSaver:s.settings&&s.settings.room&&s.settings.room.idleTimeoutMinutes?60*s.settings.room.idleTimeoutMinutes*1e3:i.screenSaverDelay}),s.settings&&s.settings.room&&(s.settings.room.name&&(n.Helium.values.roomName=s.settings.room.name),null!==s.settings.room.enableAvailableOccupiedState)&&(n.Helium.settings.room.enableAvailableOccupiedState=s.settings.room.enableAvailableOccupiedState),this.applySettingsExtras(n.Helium.settings.extras),o.loadTheme(t.theme),a.updateLayout(t.verticalOrientation),this.applyCustomCss(t.styleOverrideUrl),l<2&&l++}},this.applySettingsExtras=function(e){n.Helium.settingsExtra=angular.extend({},e)},this.applyCustomCss=function(e){n.Helium.state.customCss=e?e+"?v="+(new Date).getTime():"custom.css"},this.setNeedsPin=function(e){e=e.settings.accessControl;e&&e.securityLevel&&"anonymous"===e.securityLevel.toLowerCase()?n.Helium.state.needPin=!1:n.Helium.state.needPin=!0},this.applyProviderState=function(e){e=e.data;n.Helium.state.isOnline=e.isOnline,n.Helium.state.needsAuthorization=e.needsAuthorization,n.Helium.state.offlineLimit=e.offlineLimit,n.Helium.state.roomOccupied=e.roomOccupied,n.Helium.state.offlineLimit&&n.$evalAsync(function(){n.Helium.methods.openPage("room")})}}angular.module("helium").service("SettingsService",e),e.$inject=["$rootScope","AppConfig","LayoutService","ThemeService"]}(),function(){"use strict";function e(i,a){this.getPageTemplateUrl=function(e){var t=a.template,n=a.arabicLanguage&&void 0!==i.get(t.pageFolderPath+e+t.arabicTemplateSuffix+".html"),e=t.pageFolderPath+e+(n?t.arabicTemplateSuffix:"")+".html";return void 0!==i.get(e)?e:null},this.getModalTemplateUrl=function(e){var t=a.template,n=a.arabicLanguage&&void 0!==i.get(t.modalFolderPath+e+t.arabicTemplateSuffix+".html"),e=t.modalFolderPath+e+(n?t.arabicTemplateSuffix:"")+".html";return void 0!==i.get(e)?e:null}}angular.module("helium").service("templateService",e),e.$inject=["$templateCache","AppConfig"]}(),function(){"use strict";function e(t){this.updateTheme=function(e){t.Helium.state.vision?t.Helium.state.theme=e:this.loadTheme()},this.loadTheme=function(e){t.Helium.state.theme=e||localStorage.getItem("theme")||"dark-theme",localStorage.setItem("theme",t.Helium.state.theme)}}angular.module("helium").service("ThemeService",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(l,r,e,a,t){var n=!1,i=this;this.applyPrivacyLevelEvent=function(e){return null!==e.privacyLevel&&"public"!==e.privacyLevel.toLowerCase()&&(e.subject=l.Helium.labels.private,"private"===e.privacyLevel.toLowerCase())&&(e.organizer=l.Helium.labels.private),e},this.generateAvailableExtendTime=function(e,t,n){var i=[],a=0,o=l.Helium.settings.reservation.reserveNowMaxDur||120,s=new Date(e),o=new Date(new Date(e).setMinutes(e.getMinutes()+o));for(t=new Date(Math.min(t?t.getTime():1/0,o.getTime(),r.getMidnightTommorrow().getTime()));e<t;)(e=new Date(e.getTime()+6e4*n))<=t?a+=n:a=r.getTotalMinutesBetweenDates(s.getTime(),t.getTime()),i.push(a);return i},this.initValues=function(e){var t,n,i=e.events||[];for(l.Helium.values.roomId=e.roomId,l.Helium.values.roomName=e.roomName,l.Helium.values.mainRoom=l.Helium.values.mainRoom||{},l.Helium.values.mainRoom.events=l.Helium.values.mainRoom.events||[],l.Helium.values.mainRoom.events.splice(0,l.Helium.values.mainRoom.events.length),n=0;n<i.length;n++)(t=i[n]).dtStart=new Date(t.dtStart),t.dtEnd=new Date(t.dtEnd),t.instanceId=a.isString(t.instanceId)?t.instanceId:null,l.Helium.values.mainRoom.events.push(i[n]),this.applyPrivacyLevelEvent(t);return l.Helium.values},this.getCurrentEvent=function(e){var t,n,i=null,a=new Date;if(e&&0<e.length)for(t=0;t<e.length;t++)if((n=e[t]).dtStart<=a&&a<n.dtEnd){i=n;break}return i},this.getNextEvent=function(e){var t,n,i=null,a=new Date;if(e&&0<e.length)for(t=0;t<e.length;t++)if(a<(n=e[t]).dtStart){i=n;break}return i},this.setCurrentEvent=function(e){e?l.Helium.values.mainRoom.currentEvent={id:e.id,subject:e.subject,organizer:e.organizer,dtStart:new Date(e.dtStart),dtEnd:new Date(e.dtEnd),checkedIn:e.checkedIn,state:{countdown:r.getRoundTimeLeftTill(e.dtEnd),maxExtend:0,visibleEndNow:!1,visibleExtendNow:!1,visibleCheckInNow:!1},instanceId:a.isString(e.instanceId)?e.instanceId:null,isRecurring:e.isRecurring,privacyLevel:e.privacyLevel||"public"}:(l.Helium.values.mainRoom.currentEvent=null,l.$broadcast("currentEvent",null)),l.Helium.values.mainRoom.currentEvent&&this.applyPrivacyLevelEvent(l.Helium.values.mainRoom.currentEvent),t.applyBackground()},this.setNextEvent=function(e){l.Helium.values.mainRoom.nextEvent=e?{id:e.id,subject:e.subject,organizer:e.organizer,dtStart:new Date(e.dtStart),dtEnd:new Date(e.dtEnd),checkedIn:e.checkedIn,state:{countdown:r.getRoundTimeLeftTill(e.dtStart),visibleCheckInNow:!1},isRecurring:e.isRecurring,instanceId:a.isString(e.instanceId)?e.instanceId:null,privacyLevel:e.privacyLevel||"public"}:null,l.Helium.values.mainRoom.nextEvent&&this.applyPrivacyLevelEvent(l.Helium.values.mainRoom.nextEvent)},this.refreshStateOnCurrentMeeting=function(){var e,t=l.Helium.values.mainRoom,n=t.currentEvent,t=t.nextEvent;n&&(e=n.state,t&&n.id===t.id?e.maxExtend=0:t?(n=Math.min(90,r.getTotalMinutesBetweenDates(n.dtEnd,t.dtStart)),e.maxExtend=n,e.maxExtend<1&&(e.maxExtend=0)):e.maxExtend=90)},this.createIntervalRefresh=function(){n=!0,e.subscribe(function(){var e=l.Helium.values.mainRoom,t=e.currentEvent||{},e=e.nextEvent||{};t.dtEnd&&(t.state.countdown=r.getRoundTimeLeftTill(t.dtEnd.getTime())),e.dtEnd&&(e.state.countdown=r.getRoundTimeLeftTill(e.dtStart.getTime())),i.refreshStateOnCurrentMeeting()})},this.applyRoomTimeline=function(e){this.initValues(e);e=this.getCurrentEvent(e.events);this.setCurrentEvent(e),this.refreshStateOnCurrentMeeting()},this.applyRoomEvents=function(e){this.setNextEvent(e.nextEvent),this.setCurrentEvent(e.currentEvent),this.refreshStateOnCurrentMeeting(),n||this.createIntervalRefresh()},this.isReserved=function(){return null!==l.Helium.values.mainRoom.currentEvent},this.isAvailable=function(){var e=l.Helium.values.mainRoom.currentEvent,t=l.Helium.values.mainRoom.nextEvent;return null===e&&null!==t},this.isAvailableForTheRestOfTheDay=function(){var e=l.Helium.values.mainRoom.nextEvent;return null===l.Helium.values.mainRoom.currentEvent&&null===e}}angular.module("helium").service("TimelineService",e),e.$inject=["$rootScope","DatetimeFactory","AppClockService","UtilFactory","BackgroundService"]}();